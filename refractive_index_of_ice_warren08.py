#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Module: refractive_index_of_ice_warren08

This module provides a function to calculate the complex refractive index of ice 
based on the work of Warren and Brandt (2008). The refractive index is given for a 
temperature of 266 K and is applicable across a range of frequencies.

Function:
    refactive_index_ice_warren08(frequency, return_rawdata=False)

Created on Fri Apr  8 16:30:11 2022
Author: Manfred Brath
"""

import numpy as np
from scipy.interpolate import interp1d

import pyarts.arts as pa
import pyarts.xml as xml

# =============================================================================
#  refractive index
# =============================================================================


def refactive_index_ice_warren08(frequency, return_rawdata=False):
    """
    Complex refractive index of ice.

    Refractive index is given for a temperatur of 266 K.

    Warren, S. G., and R. E. Brandt (2008),
    Optical constants of ice from the ultraviolet to the microwave:
    A revised compilation.
    J. Geophys. Res., 113, D14220, doi:10.1029/2007JD009744.

    Args:
        frequency (TYPE): DESCRIPTION.

    Returns:
        n_real (ndarray): Real part of refractive index
        n_imag (ndarray): Imaginary part of refractive index

    """

    data = np.array(
        [
            # Lambda [10^-6 m] real index    imag. index
            [4.4300e-02, 8.2280e-01, 1.6400e-01],
            [4.5100e-02, 8.2500e-01, 1.7300e-01],
            [4.5900e-02, 8.2550e-01, 1.8300e-01],
            [4.6800e-02, 8.2580e-01, 1.9500e-01],
            [4.7700e-02, 8.2630e-01, 2.0800e-01],
            [4.8600e-02, 8.2810e-01, 2.2300e-01],
            [4.9600e-02, 8.3470e-01, 2.4000e-01],
            [5.0600e-02, 8.4280e-01, 2.5000e-01],
            [5.1700e-02, 8.4830e-01, 2.5900e-01],
            [5.2800e-02, 8.5050e-01, 2.6800e-01],
            [5.3900e-02, 8.4970e-01, 2.7900e-01],
            [5.5100e-02, 8.4890e-01, 2.9700e-01],
            [5.6400e-02, 8.5190e-01, 3.1900e-01],
            [5.7700e-02, 8.5660e-01, 3.4000e-01],
            [5.9000e-02, 8.6470e-01, 3.6600e-01],
            [6.0500e-02, 8.7970e-01, 3.9200e-01],
            [6.2000e-02, 8.9700e-01, 4.1600e-01],
            [6.3600e-02, 9.1730e-01, 4.4000e-01],
            [6.5300e-02, 9.4000e-01, 4.6400e-01],
            [6.7000e-02, 9.6790e-01, 4.9200e-01],
            [6.8900e-02, 1.0093e00, 5.1700e-01],
            [7.0800e-02, 1.0536e00, 5.2800e-01],
            [7.2900e-02, 1.0986e00, 5.3300e-01],
            [7.3800e-02, 1.1183e00, 5.3400e-01],
            [7.5100e-02, 1.1449e00, 5.3100e-01],
            [7.7500e-02, 1.1885e00, 5.2400e-01],
            [8.0000e-02, 1.2273e00, 5.1000e-01],
            [8.2700e-02, 1.2629e00, 5.0000e-01],
            [8.5500e-02, 1.3117e00, 4.9900e-01],
            [8.8600e-02, 1.3807e00, 4.6800e-01],
            [9.1800e-02, 1.4091e00, 3.8000e-01],
            [9.3000e-02, 1.4028e00, 3.6000e-01],
            [9.5400e-02, 1.3948e00, 3.3900e-01],
            [9.9200e-02, 1.3964e00, 3.1800e-01],
            [1.0330e-01, 1.4047e00, 2.9100e-01],
            [1.0780e-01, 1.3981e00, 2.5100e-01],
            [1.1000e-01, 1.3886e00, 2.4400e-01],
            [1.1270e-01, 1.3806e00, 2.3900e-01],
            [1.1400e-01, 1.3772e00, 2.3900e-01],
            [1.1810e-01, 1.3783e00, 2.4400e-01],
            [1.2100e-01, 1.3929e00, 2.4700e-01],
            [1.2400e-01, 1.4061e00, 2.2400e-01],
            [1.2720e-01, 1.3999e00, 1.9500e-01],
            [1.2950e-01, 1.3777e00, 1.7400e-01],
            [1.3050e-01, 1.3607e00, 1.7200e-01],
            [1.3190e-01, 1.3389e00, 1.8000e-01],
            [1.3330e-01, 1.3210e00, 1.9400e-01],
            [1.3480e-01, 1.3030e00, 2.1300e-01],
            [1.3620e-01, 1.2871e00, 2.4300e-01],
            [1.3700e-01, 1.2849e00, 2.7100e-01],
            [1.3780e-01, 1.2851e00, 2.8900e-01],
            [1.3870e-01, 1.2970e00, 3.3400e-01],
            [1.3930e-01, 1.3151e00, 3.4400e-01],
            [1.4090e-01, 1.3575e00, 3.8200e-01],
            [1.4250e-01, 1.4130e00, 4.0100e-01],
            [1.4350e-01, 1.4525e00, 4.0650e-01],
            [1.4420e-01, 1.4845e00, 4.0500e-01],
            [1.4500e-01, 1.5157e00, 3.8900e-01],
            [1.4590e-01, 1.5484e00, 3.7700e-01],
            [1.4680e-01, 1.5729e00, 3.4500e-01],
            [1.4760e-01, 1.5915e00, 3.3200e-01],
            [1.4800e-01, 1.6021e00, 3.1500e-01],
            [1.4850e-01, 1.6077e00, 2.9800e-01],
            [1.4940e-01, 1.6156e00, 2.7400e-01],
            [1.5120e-01, 1.6220e00, 2.2800e-01],
            [1.5310e-01, 1.6311e00, 1.9800e-01],
            [1.5400e-01, 1.6345e00, 1.7200e-01],
            [1.5500e-01, 1.6363e00, 1.5600e-01],
            [1.5690e-01, 1.6353e00, 1.1000e-01],
            [1.5800e-01, 1.6309e00, 8.3000e-02],
            [1.5890e-01, 1.6214e00, 5.8000e-02],
            [1.6100e-01, 1.5818e00, 2.2000e-02],
            [1.6300e-01, 1.5482e00, 8.4730e-03],
            [1.6500e-01, 1.5225e00, 3.2630e-03],
            [1.6700e-01, 1.5027e00, 1.2560e-03],
            [1.6900e-01, 1.4870e00, 4.8370e-04],
            [1.7100e-01, 1.4743e00, 1.8620e-04],
            [1.7300e-01, 1.4635e00, 7.1650e-05],
            [1.7500e-01, 1.4543e00, 2.7570e-05],
            [1.7700e-01, 1.4462e00, 1.0610e-05],
            [1.7900e-01, 1.4390e00, 4.0810e-06],
            [1.8100e-01, 1.4326e00, 1.5700e-06],
            [1.8300e-01, 1.4268e00, 5.4030e-07],
            [1.8500e-01, 1.4215e00, 1.8290e-07],
            [1.8700e-01, 1.4167e00, 6.2180e-08],
            [1.8900e-01, 1.4122e00, 2.1130e-08],
            [1.9100e-01, 1.4081e00, 7.1810e-09],
            [1.9300e-01, 1.4043e00, 2.4400e-09],
            [1.9500e-01, 1.4007e00, 8.2890e-10],
            [1.9700e-01, 1.3974e00, 2.8160e-10],
            [1.9900e-01, 1.3943e00, 9.5650e-11],
            [2.0100e-01, 1.3914e00, 3.2490e-11],
            [2.0190e-01, 1.3901e00, 2.0000e-11],
            [2.1000e-01, 1.3801e00, 2.0000e-11],
            [2.5000e-01, 1.3509e00, 2.0000e-11],
            [3.0000e-01, 1.3339e00, 2.0000e-11],
            [3.5000e-01, 1.3249e00, 2.0000e-11],
            [3.9000e-01, 1.3203e00, 2.0000e-11],
            [4.0000e-01, 1.3194e00, 2.3650e-11],
            [4.1000e-01, 1.3185e00, 2.6690e-11],
            [4.2000e-01, 1.3177e00, 3.1350e-11],
            [4.3000e-01, 1.3170e00, 4.1400e-11],
            [4.4000e-01, 1.3163e00, 6.2680e-11],
            [4.5000e-01, 1.3157e00, 9.2390e-11],
            [4.6000e-01, 1.3151e00, 1.3250e-10],
            [4.7000e-01, 1.3145e00, 1.9560e-10],
            [4.8000e-01, 1.3140e00, 2.8610e-10],
            [4.9000e-01, 1.3135e00, 4.1720e-10],
            [5.0000e-01, 1.3130e00, 5.8890e-10],
            [5.1000e-01, 1.3126e00, 8.0360e-10],
            [5.2000e-01, 1.3121e00, 1.0760e-09],
            [5.3000e-01, 1.3117e00, 1.4090e-09],
            [5.4000e-01, 1.3114e00, 1.8130e-09],
            [5.5000e-01, 1.3110e00, 2.2890e-09],
            [5.6000e-01, 1.3106e00, 2.8390e-09],
            [5.7000e-01, 1.3103e00, 3.4610e-09],
            [5.8000e-01, 1.3100e00, 4.1590e-09],
            [5.9000e-01, 1.3097e00, 4.9300e-09],
            [6.0000e-01, 1.3094e00, 5.7300e-09],
            [6.1000e-01, 1.3091e00, 6.8900e-09],
            [6.2000e-01, 1.3088e00, 8.5800e-09],
            [6.3000e-01, 1.3085e00, 1.0400e-08],
            [6.4000e-01, 1.3083e00, 1.2200e-08],
            [6.5000e-01, 1.3080e00, 1.4300e-08],
            [6.6000e-01, 1.3078e00, 1.6600e-08],
            [6.7000e-01, 1.3076e00, 1.8900e-08],
            [6.8000e-01, 1.3073e00, 2.0900e-08],
            [6.9000e-01, 1.3071e00, 2.4000e-08],
            [7.0000e-01, 1.3069e00, 2.9000e-08],
            [7.1000e-01, 1.3067e00, 3.4400e-08],
            [7.2000e-01, 1.3065e00, 4.0300e-08],
            [7.3000e-01, 1.3062e00, 4.3000e-08],
            [7.4000e-01, 1.3060e00, 4.9200e-08],
            [7.5000e-01, 1.3059e00, 5.8700e-08],
            [7.6000e-01, 1.3057e00, 7.0800e-08],
            [7.7000e-01, 1.3055e00, 8.5800e-08],
            [7.8000e-01, 1.3053e00, 1.0200e-07],
            [7.9000e-01, 1.3051e00, 1.1800e-07],
            [8.0000e-01, 1.3049e00, 1.3400e-07],
            [8.1000e-01, 1.3047e00, 1.4000e-07],
            [8.2000e-01, 1.3046e00, 1.4300e-07],
            [8.3000e-01, 1.3044e00, 1.4500e-07],
            [8.4000e-01, 1.3042e00, 1.5100e-07],
            [8.5000e-01, 1.3040e00, 1.8300e-07],
            [8.6000e-01, 1.3039e00, 2.1500e-07],
            [8.7000e-01, 1.3037e00, 2.6500e-07],
            [8.8000e-01, 1.3035e00, 3.3500e-07],
            [8.9000e-01, 1.3033e00, 3.9200e-07],
            [9.0000e-01, 1.3032e00, 4.2000e-07],
            [9.1000e-01, 1.3030e00, 4.4400e-07],
            [9.2000e-01, 1.3028e00, 4.7400e-07],
            [9.3000e-01, 1.3027e00, 5.1100e-07],
            [9.4000e-01, 1.3025e00, 5.5300e-07],
            [9.5000e-01, 1.3023e00, 6.0200e-07],
            [9.6000e-01, 1.3022e00, 7.5500e-07],
            [9.7000e-01, 1.3020e00, 9.2600e-07],
            [9.8000e-01, 1.3019e00, 1.1200e-06],
            [9.9000e-01, 1.3017e00, 1.3300e-06],
            [1.0000e00, 1.3015e00, 1.6200e-06],
            [1.0100e00, 1.3014e00, 2.0000e-06],
            [1.0200e00, 1.3012e00, 2.2500e-06],
            [1.0300e00, 1.3010e00, 2.3300e-06],
            [1.0400e00, 1.3009e00, 2.3300e-06],
            [1.0500e00, 1.3007e00, 2.1700e-06],
            [1.0600e00, 1.3005e00, 1.9600e-06],
            [1.0700e00, 1.3003e00, 1.8100e-06],
            [1.0800e00, 1.3002e00, 1.7400e-06],
            [1.0900e00, 1.3000e00, 1.7300e-06],
            [1.1000e00, 1.2998e00, 1.7000e-06],
            [1.1100e00, 1.2997e00, 1.7600e-06],
            [1.1200e00, 1.2995e00, 1.8200e-06],
            [1.1300e00, 1.2993e00, 2.0400e-06],
            [1.1400e00, 1.2991e00, 2.2500e-06],
            [1.1500e00, 1.2990e00, 2.2900e-06],
            [1.1600e00, 1.2988e00, 3.0400e-06],
            [1.1700e00, 1.2986e00, 3.8400e-06],
            [1.1800e00, 1.2984e00, 4.7700e-06],
            [1.1900e00, 1.2982e00, 5.7600e-06],
            [1.2000e00, 1.2980e00, 6.7100e-06],
            [1.2100e00, 1.2979e00, 8.6600e-06],
            [1.2200e00, 1.2977e00, 1.0200e-05],
            [1.2300e00, 1.2975e00, 1.1300e-05],
            [1.2400e00, 1.2973e00, 1.2200e-05],
            [1.2500e00, 1.2971e00, 1.2900e-05],
            [1.2600e00, 1.2969e00, 1.3200e-05],
            [1.2700e00, 1.2967e00, 1.3500e-05],
            [1.2800e00, 1.2965e00, 1.3300e-05],
            [1.2900e00, 1.2963e00, 1.3200e-05],
            [1.3000e00, 1.2961e00, 1.3200e-05],
            [1.3100e00, 1.2959e00, 1.3100e-05],
            [1.3200e00, 1.2957e00, 1.3200e-05],
            [1.3300e00, 1.2955e00, 1.3200e-05],
            [1.3400e00, 1.2953e00, 1.3400e-05],
            [1.3500e00, 1.2951e00, 1.3900e-05],
            [1.3600e00, 1.2949e00, 1.4200e-05],
            [1.3700e00, 1.2946e00, 1.4800e-05],
            [1.3800e00, 1.2944e00, 1.5800e-05],
            [1.3900e00, 1.2941e00, 1.7400e-05],
            [1.4000e00, 1.2939e00, 1.9800e-05],
            [1.4100e00, 1.2937e00, 3.4420e-05],
            [1.4200e00, 1.2934e00, 5.9590e-05],
            [1.4300e00, 1.2931e00, 1.0280e-04],
            [1.4400e00, 1.2929e00, 1.5160e-04],
            [1.4490e00, 1.2927e00, 2.0300e-04],
            [1.4600e00, 1.2924e00, 2.9420e-04],
            [1.4710e00, 1.2921e00, 3.9870e-04],
            [1.4810e00, 1.2920e00, 4.9410e-04],
            [1.4930e00, 1.2918e00, 5.5320e-04],
            [1.5040e00, 1.2916e00, 5.3730e-04],
            [1.5150e00, 1.2914e00, 5.1430e-04],
            [1.5270e00, 1.2912e00, 4.9080e-04],
            [1.5380e00, 1.2909e00, 4.5940e-04],
            [1.5630e00, 1.2903e00, 3.8580e-04],
            [1.5870e00, 1.2897e00, 3.1050e-04],
            [1.6130e00, 1.2890e00, 2.6590e-04],
            [1.6500e00, 1.2879e00, 2.3610e-04],
            [1.6800e00, 1.2870e00, 2.0460e-04],
            [1.7000e00, 1.2863e00, 1.8750e-04],
            [1.7300e00, 1.2853e00, 1.6500e-04],
            [1.7600e00, 1.2843e00, 1.5220e-04],
            [1.8000e00, 1.2828e00, 1.4110e-04],
            [1.8300e00, 1.2816e00, 1.3020e-04],
            [1.8400e00, 1.2811e00, 1.3100e-04],
            [1.8500e00, 1.2807e00, 1.3390e-04],
            [1.8550e00, 1.2805e00, 1.3770e-04],
            [1.8600e00, 1.2802e00, 1.4320e-04],
            [1.8700e00, 1.2797e00, 1.6320e-04],
            [1.8900e00, 1.2788e00, 2.5660e-04],
            [1.9050e00, 1.2780e00, 4.0810e-04],
            [1.9230e00, 1.2771e00, 7.0600e-04],
            [1.9420e00, 1.2762e00, 1.1080e-03],
            [1.9610e00, 1.2756e00, 1.4420e-03],
            [1.9800e00, 1.2750e00, 1.6140e-03],
            [2.0000e00, 1.2744e00, 1.6400e-03],
            [2.0200e00, 1.2736e00, 1.5660e-03],
            [2.0410e00, 1.2728e00, 1.4580e-03],
            [2.0620e00, 1.2718e00, 1.2670e-03],
            [2.0830e00, 1.2707e00, 1.0230e-03],
            [2.1050e00, 1.2694e00, 7.5860e-04],
            [2.1300e00, 1.2677e00, 5.2550e-04],
            [2.1500e00, 1.2663e00, 4.0250e-04],
            [2.1700e00, 1.2648e00, 3.2350e-04],
            [2.1900e00, 1.2633e00, 2.7070e-04],
            [2.2200e00, 1.2609e00, 2.2280e-04],
            [2.2400e00, 1.2591e00, 2.0370e-04],
            [2.2450e00, 1.2587e00, 2.0260e-04],
            [2.2500e00, 1.2582e00, 2.0350e-04],
            [2.2600e00, 1.2573e00, 2.0780e-04],
            [2.2700e00, 1.2564e00, 2.1710e-04],
            [2.2900e00, 1.2545e00, 2.5380e-04],
            [2.3100e00, 1.2525e00, 3.1380e-04],
            [2.3300e00, 1.2504e00, 3.8580e-04],
            [2.3500e00, 1.2482e00, 4.5910e-04],
            [2.3700e00, 1.2459e00, 5.1870e-04],
            [2.3900e00, 1.2435e00, 5.6050e-04],
            [2.4100e00, 1.2409e00, 5.9560e-04],
            [2.4300e00, 1.2382e00, 6.2590e-04],
            [2.4600e00, 1.2337e00, 6.8200e-04],
            [2.5000e00, 1.2270e00, 7.5300e-04],
            [2.5200e00, 1.2232e00, 7.6850e-04],
            [2.5500e00, 1.2169e00, 7.6470e-04],
            [2.5650e00, 1.2135e00, 7.4730e-04],
            [2.5800e00, 1.2097e00, 7.3920e-04],
            [2.5900e00, 1.2071e00, 7.4370e-04],
            [2.6000e00, 1.2043e00, 7.5430e-04],
            [2.6200e00, 1.1983e00, 8.0590e-04],
            [2.6750e00, 1.1776e00, 1.3670e-03],
            [2.7250e00, 1.1507e00, 3.5080e-03],
            [2.7780e00, 1.1083e00, 1.3460e-02],
            [2.8170e00, 1.0657e00, 3.2450e-02],
            [2.8330e00, 1.0453e00, 4.5720e-02],
            [2.8490e00, 1.0236e00, 6.2870e-02],
            [2.8650e00, 1.0001e00, 8.5480e-02],
            [2.8820e00, 9.7470e-01, 1.1980e-01],
            [2.8990e00, 9.5630e-01, 1.6900e-01],
            [2.9150e00, 9.5380e-01, 2.2100e-01],
            [2.9330e00, 9.6780e-01, 2.7600e-01],
            [2.9500e00, 9.8730e-01, 3.1200e-01],
            [2.9670e00, 1.0026e00, 3.4700e-01],
            [2.9850e00, 1.0180e00, 3.8800e-01],
            [3.0030e00, 1.0390e00, 4.3800e-01],
            [3.0210e00, 1.0722e00, 4.9300e-01],
            [3.0400e00, 1.1259e00, 5.5400e-01],
            [3.0580e00, 1.2089e00, 6.1200e-01],
            [3.0770e00, 1.3215e00, 6.2500e-01],
            [3.0960e00, 1.4225e00, 5.9300e-01],
            [3.1150e00, 1.4933e00, 5.3900e-01],
            [3.1350e00, 1.5478e00, 4.9100e-01],
            [3.1550e00, 1.5970e00, 4.3800e-01],
            [3.1750e00, 1.6336e00, 3.7200e-01],
            [3.1950e00, 1.6477e00, 3.0000e-01],
            [3.2150e00, 1.6405e00, 2.3800e-01],
            [3.2360e00, 1.6248e00, 1.9300e-01],
            [3.2570e00, 1.6108e00, 1.5800e-01],
            [3.2790e00, 1.5905e00, 1.2100e-01],
            [3.3000e00, 1.5714e00, 1.0300e-01],
            [3.3220e00, 1.5559e00, 8.3600e-02],
            [3.3450e00, 1.5396e00, 6.6800e-02],
            [3.3670e00, 1.5241e00, 5.3120e-02],
            [3.3900e00, 1.5086e00, 4.2860e-02],
            [3.4130e00, 1.4949e00, 3.5230e-02],
            [3.4360e00, 1.4827e00, 2.8870e-02],
            [3.4600e00, 1.4710e00, 2.3470e-02],
            [3.4840e00, 1.4604e00, 1.9210e-02],
            [3.5090e00, 1.4502e00, 1.5860e-02],
            [3.5340e00, 1.4411e00, 1.3260e-02],
            [3.5590e00, 1.4328e00, 1.1300e-02],
            [3.6240e00, 1.4146e00, 8.1460e-03],
            [3.7320e00, 1.3924e00, 6.6720e-03],
            [3.7750e00, 1.3850e00, 6.9660e-03],
            [3.8470e00, 1.3750e00, 8.2480e-03],
            [3.9690e00, 1.3623e00, 1.1120e-02],
            [4.0990e00, 1.3526e00, 1.4710e-02],
            [4.2390e00, 1.3447e00, 1.8670e-02],
            [4.3480e00, 1.3406e00, 2.4110e-02],
            [4.3870e00, 1.3401e00, 2.6560e-02],
            [4.4440e00, 1.3412e00, 2.9900e-02],
            [4.5050e00, 1.3444e00, 3.1790e-02],
            [4.5470e00, 1.3473e00, 3.0900e-02],
            [4.5600e00, 1.3482e00, 3.0070e-02],
            [4.5800e00, 1.3491e00, 2.8830e-02],
            [4.7190e00, 1.3470e00, 1.9400e-02],
            [4.9040e00, 1.3379e00, 1.3470e-02],
            [5.0000e00, 1.3325e00, 1.2400e-02],
            [5.1000e00, 1.3268e00, 1.2200e-02],
            [5.2000e00, 1.3212e00, 1.3020e-02],
            [5.2630e00, 1.3176e00, 1.3800e-02],
            [5.4000e00, 1.3100e00, 1.6830e-02],
            [5.5560e00, 1.3013e00, 2.2320e-02],
            [5.7140e00, 1.2933e00, 3.2560e-02],
            [5.7470e00, 1.2917e00, 3.5390e-02],
            [5.7800e00, 1.2906e00, 3.8830e-02],
            [5.8140e00, 1.2902e00, 4.2700e-02],
            [5.8480e00, 1.2904e00, 4.6430e-02],
            [5.8820e00, 1.2915e00, 5.0450e-02],
            [6.0610e00, 1.3015e00, 6.4390e-02],
            [6.1350e00, 1.3083e00, 6.5600e-02],
            [6.2500e00, 1.3152e00, 6.3600e-02],
            [6.2890e00, 1.3167e00, 6.2650e-02],
            [6.3290e00, 1.3178e00, 6.1700e-02],
            [6.3690e00, 1.3187e00, 6.1010e-02],
            [6.4100e00, 1.3194e00, 6.0310e-02],
            [6.4520e00, 1.3201e00, 5.9640e-02],
            [6.4940e00, 1.3207e00, 5.8990e-02],
            [6.5790e00, 1.3214e00, 5.7800e-02],
            [6.6670e00, 1.3219e00, 5.7000e-02],
            [6.7570e00, 1.3229e00, 5.6800e-02],
            [6.8970e00, 1.3242e00, 5.4280e-02],
            [7.0420e00, 1.3244e00, 5.1610e-02],
            [7.1430e00, 1.3236e00, 4.9400e-02],
            [7.2460e00, 1.3229e00, 4.8400e-02],
            [7.3530e00, 1.3218e00, 4.6000e-02],
            [7.4630e00, 1.3200e00, 4.4400e-02],
            [7.5760e00, 1.3183e00, 4.2900e-02],
            [7.6920e00, 1.3158e00, 4.0410e-02],
            [7.8120e00, 1.3123e00, 3.9110e-02],
            [7.9370e00, 1.3086e00, 3.8190e-02],
            [8.0650e00, 1.3047e00, 3.7600e-02],
            [8.1970e00, 1.3007e00, 3.7240e-02],
            [8.3330e00, 1.2964e00, 3.7000e-02],
            [8.4750e00, 1.2917e00, 3.6770e-02],
            [8.6960e00, 1.2835e00, 3.6540e-02],
            [8.9290e00, 1.2735e00, 3.6640e-02],
            [9.0910e00, 1.2655e00, 3.7060e-02],
            [9.2590e00, 1.2561e00, 3.7890e-02],
            [9.5240e00, 1.2387e00, 4.0260e-02],
            [9.8040e00, 1.2151e00, 4.4500e-02],
            [1.0000e01, 1.1926e00, 5.0080e-02],
            [1.0200e01, 1.1659e00, 6.4610e-02],
            [1.0310e01, 1.1501e00, 7.5000e-02],
            [1.0420e01, 1.1323e00, 8.8000e-02],
            [1.0530e01, 1.1136e00, 1.0800e-01],
            [1.0640e01, 1.0971e00, 1.3400e-01],
            [1.0750e01, 1.0867e00, 1.6800e-01],
            [1.0870e01, 1.0833e00, 2.0400e-01],
            [1.1000e01, 1.0886e00, 2.4800e-01],
            [1.1110e01, 1.1023e00, 2.8000e-01],
            [1.1360e01, 1.1439e00, 3.4100e-01],
            [1.1630e01, 1.1983e00, 3.7900e-01],
            [1.1900e01, 1.2546e00, 4.0900e-01],
            [1.2200e01, 1.3194e00, 4.2200e-01],
            [1.2500e01, 1.3822e00, 4.2200e-01],
            [1.2820e01, 1.4412e00, 4.0300e-01],
            [1.2990e01, 1.4683e00, 3.8900e-01],
            [1.3160e01, 1.4928e00, 3.7400e-01],
            [1.3330e01, 1.5132e00, 3.5400e-01],
            [1.3510e01, 1.5300e00, 3.3500e-01],
            [1.3700e01, 1.5458e00, 3.1500e-01],
            [1.3890e01, 1.5596e00, 2.9400e-01],
            [1.4080e01, 1.5701e00, 2.7100e-01],
            [1.4290e01, 1.5775e00, 2.4600e-01],
            [1.4710e01, 1.5762e00, 1.9800e-01],
            [1.5150e01, 1.5637e00, 1.6400e-01],
            [1.5380e01, 1.5559e00, 1.5200e-01],
            [1.5630e01, 1.5481e00, 1.4200e-01],
            [1.6130e01, 1.5353e00, 1.2800e-01],
            [1.6390e01, 1.5302e00, 1.2500e-01],
            [1.6670e01, 1.5294e00, 1.2300e-01],
            [1.6950e01, 1.5306e00, 1.1600e-01],
            [1.7240e01, 1.5303e00, 1.0700e-01],
            [1.8180e01, 1.5141e00, 7.9000e-02],
            [1.8320e01, 1.5104e00, 7.7520e-02],
            [1.8610e01, 1.5043e00, 7.4550e-02],
            [1.8870e01, 1.4982e00, 7.2000e-02],
            [1.9230e01, 1.4939e00, 7.6000e-02],
            [1.9610e01, 1.4963e00, 7.5000e-02],
            [2.0000e01, 1.4986e00, 6.7000e-02],
            [2.0410e01, 1.4956e00, 5.5000e-02],
            [2.0830e01, 1.4877e00, 4.5000e-02],
            [2.2220e01, 1.4575e00, 2.9000e-02],
            [2.2600e01, 1.4486e00, 2.7500e-02],
            [2.3050e01, 1.4390e00, 2.7000e-02],
            [2.3600e01, 1.4282e00, 2.7300e-02],
            [2.4600e01, 1.4102e00, 2.8900e-02],
            [2.5000e01, 1.4030e00, 3.0000e-02],
            [2.6000e01, 1.3854e00, 3.4000e-02],
            [2.8570e01, 1.3404e00, 5.1220e-02],
            [3.1000e01, 1.2969e00, 8.6150e-02],
            [3.3330e01, 1.2641e00, 1.3480e-01],
            [3.4480e01, 1.2530e00, 1.6150e-01],
            [3.5640e01, 1.2445e00, 1.8950e-01],
            [3.7000e01, 1.2371e00, 2.2270e-01],
            [3.8240e01, 1.2317e00, 2.5280e-01],
            [3.9600e01, 1.2243e00, 2.8530e-01],
            [4.1140e01, 1.2054e00, 3.2400e-01],
            [4.2760e01, 1.1742e00, 3.9450e-01],
            [4.3580e01, 1.1549e00, 4.5210e-01],
            [4.4580e01, 1.1496e00, 5.5350e-01],
            [4.5500e01, 1.1853e00, 6.7820e-01],
            [4.6150e01, 1.2543e00, 7.6840e-01],
            [4.6710e01, 1.3474e00, 8.2540e-01],
            [4.7360e01, 1.4725e00, 8.4580e-01],
            [4.8000e01, 1.5874e00, 8.1580e-01],
            [4.8780e01, 1.6841e00, 7.4140e-01],
            [5.0030e01, 1.7505e00, 6.1910e-01],
            [5.1280e01, 1.7649e00, 5.3530e-01],
            [5.2750e01, 1.7668e00, 4.7800e-01],
            [5.3500e01, 1.7687e00, 4.5990e-01],
            [5.4240e01, 1.7792e00, 4.4680e-01],
            [5.5000e01, 1.7955e00, 4.2140e-01],
            [5.5740e01, 1.8052e00, 3.8600e-01],
            [5.6400e01, 1.8041e00, 3.5080e-01],
            [5.7000e01, 1.7940e00, 3.1960e-01],
            [5.7460e01, 1.7805e00, 2.9810e-01],
            [5.8400e01, 1.7410e00, 2.6590e-01],
            [5.9290e01, 1.6930e00, 2.5690e-01],
            [6.0000e01, 1.6610e00, 2.7850e-01],
            [6.1000e01, 1.6419e00, 3.0760e-01],
            [6.1250e01, 1.6396e00, 3.1460e-01],
            [6.2500e01, 1.6372e00, 3.4710e-01],
            [6.3780e01, 1.6471e00, 3.7480e-01],
            [6.4670e01, 1.6596e00, 3.9020e-01],
            [6.5580e01, 1.6754e00, 4.0240e-01],
            [6.6550e01, 1.6945e00, 4.1150e-01],
            [6.7600e01, 1.7167e00, 4.1670e-01],
            [6.9000e01, 1.7466e00, 4.1670e-01],
            [7.0530e01, 1.7780e00, 4.0890e-01],
            [7.3000e01, 1.8185e00, 3.8300e-01],
            [7.5000e01, 1.8419e00, 3.5430e-01],
            [7.6290e01, 1.8504e00, 3.3400e-01],
            [8.0000e01, 1.8617e00, 2.9440e-01],
            [8.2970e01, 1.8669e00, 2.6790e-01],
            [8.5000e01, 1.8688e00, 2.5190e-01],
            [8.6800e01, 1.8699e00, 2.3900e-01],
            [9.0800e01, 1.8698e00, 2.1400e-01],
            [9.5170e01, 1.8681e00, 1.9130e-01],
            [1.0000e02, 1.8654e00, 1.7060e-01],
            [1.2000e02, 1.8499e00, 1.1510e-01],
            [1.6000e02, 1.8268e00, 6.6840e-02],
            [2.1000e02, 1.8114e00, 4.2820e-02],
            [3.0000e02, 1.7989e00, 2.5490e-02],
            [5.0000e02, 1.7908e00, 1.4050e-02],
            [1.3000e03, 1.7868e00, 5.1730e-03],
            [5.0000e03, 1.7861e00, 1.3370e-03],
            [1.9000e04, 1.7861e00, 3.5740e-04],
            [3.9000e04, 1.7861e00, 1.8390e-04],
            [6.1000e04, 1.7861e00, 1.2940e-04],
            [8.6000e04, 1.7861e00, 1.0580e-04],
            [1.1000e05, 1.7861e00, 9.6750e-05],
            [1.4000e05, 1.7861e00, 9.3600e-05],
            [1.8000e05, 1.7861e00, 9.6130e-05],
            [2.4000e05, 1.7861e00, 1.0660e-04],
            [3.4000e05, 1.7861e00, 1.3120e-04],
            [5.4000e05, 1.7861e00, 1.8950e-04],
            [1.0000e06, 1.7861e00, 3.3480e-04],
            [2.0000e06, 1.7861e00, 6.5960e-04],
        ]
    )

    f_data = pa.constants.c / (data[:, 0] * 1e-6)
    n_data = data[:, 1:]

    if return_rawdata:
        return f_data, n_data

    else:
        # interpolate
        F_int = interp1d(f_data, n_data, axis=0, bounds_error=False)

        n_int = F_int(frequency)

        return n_int[:, 0], n_int[:, 1]


# %%

if __name__ == "__main__":

    frequency = np.logspace(6, 19, 1000)

    n_real, n_imag = refactive_index_ice_warren08(frequency)

    import matplotlib.pyplot as plt

    plt.figure()
    plt.semilogx(pa.constants.c / frequency, n_real)
    plt.semilogx(pa.constants.c / frequency, n_imag)

    f_raw, n_raw = refactive_index_ice_warren08([], return_rawdata=True)

    n_new = np.reshape(n_raw, (np.size(n_raw, axis=0), 1, np.size(n_raw, axis=1)))

    data = pa.GriddedField3()
    data.data = n_new
    data.grids = [f_raw, np.array([266]), ["real", "imaginary"]]
    data.gridnames = ["Frequency", "Temperature", "Complex"]

    xml.save(data, "complex_refr_indexIceWarren08_data.xml")

    # %%

    with open("ReadMe_complex_refr_indexIceWarren08", "w") as fout:
        fout.write("Complex refractive index of ice\n")
        fout.write("\n")
        fout.write("Warren, S. G., and R. E. Brandt\n")
        fout.write(
            "Optical constants of ice from the ultraviolet to the microwave:A revised compilation..\n"
        )
        fout.write("J. Geophys. Res., 113, D14220, doi:10.1029/2007JD009744.\n")
        fout.write("\n")
        fout.write("No temperature dependency. Nominal temperature: 266 K\n")
